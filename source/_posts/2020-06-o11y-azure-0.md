---
title: Elastic Observability ë¥¼ ì´ìš©í•œ Azure ëª¨ë‹ˆí„°ë§ #0
tags:
  - Elasticsearch
  - Elastic
  - Observability
  - Azure
  - Monitoring
  - ëª¨ë‹ˆí„°ë§
  - í†µí•© ê°€ì‹œì„±
  - Meetup
subtitle: Elastic Observability ë¥¼ ì´ìš©í•´ì„œ Azure í´ë¼ìš°ë“œë¥¼ ëª¨ë‹ˆí„°ë§ í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë´…ë‹ˆë‹¤. ê·¸ ì²«ë²ˆì§¸ë¡œ ì¤€ë¹„ ë‹¨ê³„ì…ë‹ˆë‹¤.
header-img: datacenter.jpg
categories:
  - Engineering
date: 2020-06-16
---

COVID-19 ë•Œë¬¸ì— ì»¤ë®¤ë‹ˆí‹° ë°‹ì—…ì„ ì˜¨ë¼ì¸ìœ¼ë¡œ ì§„í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤. 2020ë…„ 6ì›”ì—ëŠ” Elastic Observability ë¥¼ ì´ìš©í•´ì„œ Azure í´ë¼ìš°ë“œì˜ ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ê³  ì‹œê°í™” í•˜ëŠ” ë‚´ìš©ìœ¼ë¡œ ì§„í–‰ì„ í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ë°‹ì—… ì‹œê°„ ë™ì•ˆ ëª¨ë“  ì‘ì—…ì„ ì§„í–‰í•˜ê¸°ê°€ ì–´ë ¤ì›Œì„œ Azure í´ë¼ìš°ë“œì™€ Elastic í´ë¼ìš°ë“œì˜ í´ëŸ¬ìŠ¤í„°ì™€ ê°€ìƒ ë¨¸ì‹ ë“¤ì„ ìƒì„±í•˜ëŠ” ì‘ì—…ì€ ì‚¬ì „ì— ì§„í–‰ í•´ ë†“ìœ¼ë ¤ê³  í•©ë‹ˆë‹¤.

ì•„ë˜ëŠ” ì‚¬ì „ ì‘ì—… ì˜ìƒê³¼, ì‘ì—…ì— ì‚¬ìš©ëœ Azure Cli ëª…ë ¹ì–´ ì…ë‹ˆë‹¤.

<iframe width="560" height="315" src="https://www.youtube.com/embed/jDGd4c62Rx4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

```
# Azure ë¡œê·¸ì¸
az login

# ëŒ€í•œë¯¼êµ­ ì¤‘ë¶€ì— ë¦¬ì†ŒìŠ¤ ê·¸ë£¹ o11y-az ìƒì„± 
az group create --name o11y-az --location koreacentral

# ë¦¬ì†ŒìŠ¤ ê·¸ë£¹ì— ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ê·¸ë£¹ o11y-az-sec ìƒì„±
az network nsg create --resource-group o11y-az /
--name o11y-az-sec --location koreacentral

# ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ê·¸ë£¹ì— í¬íŠ¸ ssh:22, http:80 í¬íŠ¸ë¥¼ ì™¸ë¶€ë¡œë¶€í„° ì ‘ì† ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
az network nsg rule create --resource-group o11y-az --nsg-name o11y-az-sec /
--name ssh --access Allow --protocol Tcp --direction Inbound --priority 100 /
--source-address-prefix Internet --source-port-range "*" /
--destination-address-prefix "*" --destination-port-range 22

az network nsg rule create --resource-group o11y-az --nsg-name o11y-az-sec /
--name http --access Allow --protocol Tcp --direction Inbound --priority 200 /
--source-address-prefix Internet --source-port-range "*" /
--destination-address-prefix "*" --destination-port-range 80

# ë¦¬ì†ŒìŠ¤ ê·¸ë£¹ì— ê°€ìƒ ë„¤íŠ¸ì›Œí¬ o11y-az-vn ìƒì„±
az network vnet create --resource-group o11y-az --name o11y-az-vn /
--address-prefix 10.0.0.0/16 --subnet-name default

# ê°€ìƒ ë„¤íŠ¸ì›Œí¬ì— ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ê·¸ë£¹ ì ìš©
az network vnet subnet update --resource-group o11y-az /
--vnet-name o11y-az-vn /--name default --network-security-group o11y-az-sec

# ë¦¬ì†ŒìŠ¤ ê·¸ë£¹ì— ê°€ìƒ ë¨¸ì‹  o11y-az-vm ìƒì„± í›„ ìƒì„±ëœ ê°€ìƒ ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°
# ì´ë¯¸ì§€ : UbuntuServer:18.04-LTS / ë””ìŠ¤í¬ : 50GB
az vm create --resource-group o11y-az \
--name o11y-az-vm --image Canonical:UbuntuServer:18.04-LTS:latest \
--size Standard_D2s_v3 --data-disk-sizes-gb 50 \
--public-ip-address-allocation static \
--vnet-name o11y-az-vn --subnet default --nsg o11y-az-sec --generate-ssh-keys --verbose
```

ìœ„ ëª…ë ¹ëŒ€ë¡œ ì‹¤í–‰í•˜ê³  ë‚˜ë©´ Azure í¬í„¸ì— ë‹¤ìŒê³¼ ê°™ì´ o11y-az ë¦¬ì†ŒìŠ¤ ê·¸ë£¹ê³¼ í•„ìš”í•œ ìì›ë“¤ì´ ìƒì„±ë©ë‹ˆë‹¤.

![](az-resources.png)

ë‹¹ì—°í•œ ì´ì•¼ê¸°ì§€ë§Œ ë¦¬ì†ŒìŠ¤ ê·¸ë£¹ê³¼ ìì› ì´ë¦„ë“¤ì€ ì„ì˜ë¡œ ì„¤ì •ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë¦¬ì†ŒìŠ¤ ê·¸ë£¹ë§Œ ì‚­ì œí•˜ë©´ í¬í•¨ëœ ëª¨ë“  ìì›ë“¤ì´ ì‚­ì œë˜ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ í›„ ì´ˆê¸°í™” í•˜ê¸° í¸í•©ë‹ˆë‹¤.
ê³„ì† í•´ì„œ ì˜ìƒì„ ì°¸ê³ í•´ì„œ ê°€ìƒ ë¨¸ì‹ ì— ì ‘ì†í•˜ê³  nginx ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```
# ê°€ìƒ ë¨¸ì‹ ì— ì—°ê²°
ssh -i <private key path> user_id@<ip address>

# nginx ì„¤ì¹˜
sudo apt-get update
sudo apt-get install nginx
sudo service nginx restart
```

Metricbeat ê³¼ Filebeat ì€ ì•„ë˜ ë§í¬ì—ì„œ ë‹¤ìš´ë¡œë“œ í•œ ë’¤ Kibana ì— ìˆëŠ” ì•ˆë‚´ëŒ€ë¡œ ì„¤ì¹˜í•˜ë©´ ë©ë‹ˆë‹¤.
https://www.elastic.co/downloads/beats/metricbeat
https://www.elastic.co/downloads/beats/filebeat

![](kibana-intro.png)

> ps:ì˜ìƒì— ì‚¬ìš©ëœ Elastic Cloud í´ëŸ¬ìŠ¤í„°ì™€ Azure ë¦¬ì†ŒìŠ¤ëŠ” ì˜ìƒ ë…¹í™” í›„ ëª¨ë‘ ì‚­ì œ í–ˆìŠµë‹ˆë‹¤. ğŸ¤“